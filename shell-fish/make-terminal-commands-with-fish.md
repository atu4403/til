# WIP
<!-- # fishでターミナルコマンドを自作する -->

## 自作コマンドとは

あなたの`.zshrc`にこんな記述はありませんか？

```bash
function cd() {builtin cd $@ && ls -lhaf }
```

これは`cd`でディレクトリを移動した時にそのまま`ls`コマンドを動作させる設定です。

> はじめて`zsh`を使う時に`.zshrc`の書き方をネットで探し、そのままコピペして使ってる人はすでに使える状態になっているかもしれません。

`cd`で移動した後はとりあえずそのディレクトリの内容を知りたい、なら一発で使えるようにしょう。

このように「〇〇を一気にできたら便利なのにな」と思ったことを気軽に実現できるのが自作コマンドの利点です。例えば以下のようなことは自作コマンドで実現できます。

- ディレクトリAのファイルから指定してディレクトリBにコピーしたい
- GitHubからCloneしたリポジトリのREADMEを見たい
- プロジェクトの内容に応じてREADMEを自動作成させたい

アイデア次第でもっと色々なことを自動化することができます。

ターミナルで使えるコマンドを自作する方法は多々あります。`python`や`java script`を始め`bash`や`zsh`で書くこともできますが、ここでは`fish`を使った方法を紹介します。

## fishでコマンドを作る利点

- コマンドファイルの作成や編集が簡単
- 文法が比較的わかりやすい

### コマンドファイルの作成や編集が簡単

例えば`bash`で自作コマンドを作る場合、以下の作業が必要です。

- 自作コマンド用のファイルを作成
  - ファイル名に拡張子を付けるかどうか問題勃発
  - 拡張子を付けたらコマンド呼び出しにも拡張子が必要になる
  - 拡張子を付けなければエディタのハイライトが効かない
  - リンクを貼れば解決だけど手間が増える
- 適切な場所に設置
  - dotfiles内が一般的？
  - ファイルを置く場所を指定するor移動する作業が付随する
  - 面倒だから設定ファイル内に直書きする？
- シバンを貼る
  - シバンってどう書くんだっけ？
  - `#!/bin/sh`?`#!/bin/bash`?どっち?
- 実行権限を付与する
  - 忘れててエラーが出るのあるある
  - `chmod +x foo/bar/mycmd.sh`
- シンボリックリンクを作成
  - `ln -s source target`
  - どっちが`source`になるんだっけ？

...などなど、コードを書く以外の作業が面倒ですが`fish`なら解決です。

1. コマンドラインに`function コマンド名`として直接書けばコマンド完成(=呼び出し可能)
2. `funcsave コマンド名`で適切な場所にファイル作成
3. `funced コマンド名`で編集開始(好きなエディタを指定可)
4. `functions コマンド名`で内容確認

シバンの貼り付けや実行権限の付与は必要ありません。問題点は他のシェルで動かないことですが、`zsh`独自の書き方をしていれば`bash`では動かないし`bash`独自の書き方では`sh`で動かないので同じです。

### 文法が比較的わかりやすい

一般的なシェルスクリプトは`if`を閉じるのが`fi`で`case`を閉じるのが`esac`なので気持ち悪い。`fish`なら閉じるのは全て`end`です。

あと`case`で使われる`foo) bar;;`ってやつ。閉じ括弧だけ出てくるのが気持ち悪いし顔文字なんなの？って思ってしまう。

決してdisってるんじゃないですよ。でもシェルスクリプト苦手勢の大半はこのあたりが敬遠する理由になっているはず。

`fish`は`python`や`ruby`等の軽量言語を好む層にとっては素直で入りやすい文法になっています。

#### zshの例

```bash
case "$(uname)" in
    Darwin)
        if [[ -d /Applications/MacVim.app ]]; then
            export EDITOR=/Applications/MacVim.app/Contents/MacOS/Vim
        fi
        ;;
    *) ;;
esac
```

#### fishの例

```bash
 switch (uname)
     case Darwin
         if test -d /Applications/Emacs.app
             set -gx EDITOR /Applications/Emacs.app/Contents/MacOS/Emacs
         end
 end
```
